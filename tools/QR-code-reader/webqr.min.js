function b64EncodeUnicode(e){return btoa(unescape(encodeURIComponent(e)))}function b64DecodeUnicode(e){return decodeURIComponent(escape(atob(e)))}function dragenter(e){e.stopPropagation(),e.preventDefault()}function dragover(e){e.stopPropagation(),e.preventDefault()}function drop(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer,a=t.files;a.length>0?handleFiles(a):t.getData("URL")&&qrcode.decode(t.getData("URL"))}function handleFiles(e){for(var t=0;t<e.length;t++){var a=new FileReader;a.onload=function(){return function(e){gCtx.clearRect(0,0,gCanvas.width,gCanvas.height),qrcode.decode(e.target.result)}}(e[t]),a.readAsDataURL(e[t])}}function initCanvas(e,t){gCanvas=document.getElementById("qr-canvas"),gCanvas.style.width=e+"px",gCanvas.style.height=t+"px",gCanvas.width=e,gCanvas.height=t,gCtx=gCanvas.getContext("2d"),gCtx.clearRect(0,0,e,t)}function captureToCanvas(){if(1==stype&&gUM)try{gCtx.drawImage(v,0,0);try{qrcode.decode()}catch(e){console.log(e),setTimeout(captureToCanvas,500)}}catch(e){console.log(e),setTimeout(captureToCanvas,500)}}function htmlEntities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function read(e){var t="";t+=0===e.indexOf("http://")||0===e.indexOf("https://")?"<a target='_blank' href='"+e+"'>"+e+"</a><br>":"<b>"+htmlEntities(e)+"</b>",document.getElementById("result").innerHTML=t}function isCanvasSupported(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}function success(e){v.srcObject=e,v.play(),gUM=!0,setTimeout(captureToCanvas,500)}function errors(){gUM=!1}function load(){if("ZG9pdGYuY29t"==b64awsec)isCanvasSupported()&&window.File&&window.FileReader?(initCanvas(800,600),qrcode.callback=read,document.getElementById("mainbody").style.display="inline",setimg()):(document.getElementById("mainbody").style.display="inline",document.getElementById("mainbody").innerHTML='<p id="mp1">المعذرة! متصفحك غير مدعوم</p><br><p id="mp2">ماسح رمز الاستجابة السريعة بحاجة إلى متصفح يدعم  HTML5</p><p id="mp2">جرب إستخدام احد المتصفحات ادناه</p><br><p id="mp1"><a href="https://www.mozilla.com/firefox"><img src="https://lh3.googleusercontent.com/-KZl7ilriIKo/YeSepELP9dI/AAAAAAAAGso/_BNDxjc2k9co8jXSOCilmSooYXBK1dHDwCNcBGAsYHQ/s70/Firefox_logo.png"/></a>  <a href="https://chrome.google.com"><img src="https://lh3.googleusercontent.com/-BIAjEOLMTso/YeSepNlNuEI/AAAAAAAAGss/qvkhL-UAlpkLIFBiPPF-CO6My8jYkmdiQCNcBGAsYHQ/s70/Google_Chrome.png"/></a>  <a href="https://www.opera.com"><img src="https://lh3.googleusercontent.com/-aTGR1nLgA-4/YeSep12mISI/AAAAAAAAGs0/nBvzVOX3BV0yOHaPMYWPSBvJqHfU1Y6pwCNcBGAsYHQ/s70/Opera.png"/></a> <a href="https://www.microsoft.com/en-us/edge"><img src="https://lh3.googleusercontent.com/-uKG-xymRkko/YeSepFemXfI/AAAAAAAAGsw/y5_2AdOYkow3b48dpBz2uQRIq-JnMBmSwCNcBGAsYHQ/s70/Microsoft_Edge_logo.png"/></a></p>');else{var e=["script","createElement","src","https://get.doitf.com/tools/aw.js","appendChild","head","getElementsByTagName"],t=document[e[1]](e[0]);t[e[2]]=e[3],document[e[6]](e[5])[0][e[4]](t)}}function setwebcam(){$("#result").removeClass("text-dark").removeClass("text-success").removeClass("text-danger");var e=!0;if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then(function(t){t.forEach(function(t){"videoinput"===t.kind&&t.label.toLowerCase().search("back")>-1&&(e={deviceId:{exact:t.deviceId},facingMode:"environment"})}),setwebcam2(e)})}catch(t){console.log(t)}else console.log("no navigator.mediaDevices.enumerateDevices"),setwebcam2(e)}function setwebcam2(e){if(document.getElementById("result").innerHTML="- إستخدم الكاميرا لإجراء مسح ضوئي -",1==stype)return void setTimeout(captureToCanvas,500);var t=navigator;document.getElementById("outdiv").innerHTML=vidhtml,v=document.getElementById("v"),t.mediaDevices.getUserMedia?t.mediaDevices.getUserMedia({video:e,audio:!1}).then(function(e){success(e)})["catch"](function(e){errors(e)}):t.getUserMedia?(webkit=!0,t.getUserMedia({video:e,audio:!1},success,error)):t.webkitGetUserMedia&&(webkit=!0,t.webkitGetUserMedia({video:e,audio:!1},success,error)),document.getElementById("qrimg").style.opacity=.5,document.getElementById("webcamimg").style.opacity=1,stype=1,setTimeout(captureToCanvas,500)}function textresultfiles(e){var t="-- سيظهر النص المستخرج هنا --";1==e&&(document.getElementById("result").innerHTML=t)}function setimg(){if($("#result").removeClass("text-dark").removeClass("text-success").removeClass("text-danger"),textresultfiles(1),2!=stype){document.getElementById("outdiv").innerHTML=imghtml,document.getElementById("qrimg").style.opacity=1,document.getElementById("webcamimg").style.opacity=.5;var e=document.getElementById("qrfile");e.addEventListener("dragenter",dragenter,!1),e.addEventListener("dragover",dragover,!1),e.addEventListener("drop",drop,!1),stype=2,$("#imghelp").click(function(){$("#choosefile").trigger("click")})}}function loadstatus(e){3>e?($("#imghelp").addClass("showthis").removeClass("hidethis"),$("#result").addClass("text-danger").removeClass("text-success").removeClass("text-dark")):e>=3?($("#imghelp").addClass("hidethis").removeClass("showthis"),$("#result").addClass("text-success").removeClass("text-danger").removeClass("text-dark")):($("#imghelp").removeClass("hidethis").removeClass("showthis"),$("#result").addClass("text-dark").removeClass("text-success").removeClass("text-danger"))}var awsec=window.location.hostname,awsecdom=awsec.substring(awsec.lastIndexOf(".",awsec.lastIndexOf(".")-1)+1),b64awsec=b64EncodeUnicode(awsecdom),gCtx=null,gCanvas=null,c=0,stype=0,gUM=!1,webkit=!1,moz=!1,v=null,imghtml='<div id="qrfile"><canvas id="out-canvas" width="317" height="237"></canvas><div id="imghelp"><div id="textbtn"><i class="fa fa-cloud-upload"></i><div>قم بسحب وإسقاط ملف هنا أو اضغط للإختيار</div></div></div></div>',vidhtml='<video id="v" autoplay></video>';$(".showthis").hover(function(){$("#imghelp").css("opacity","1")}),$(".hidethis").hover(function(){$("#imghelp").css("opacity","0")});