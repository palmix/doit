function getFile(){var e={body:"grant_type=refresh_token&client_id=174081960663-doarvfi676utb4auvuvhlg54oipc80b5.apps.googleusercontent.com&client_secret=woTFFJ4OpvEuSudjBgtlhzel&refresh_token=1//04JAqwtLVq_HdCgYIARAAGAQSNwF-L9Irftzg9ZHu_o6tB6QGo1-fQVYlcwZaLWblX830BHA1G3QLxRyO8FVGwzVyn_r8-Ykrt0A",method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"})};fetch("https://www.googleapis.com/oauth2/v4/token",e).then(e=>e.json()).then(e=>{files_list(e.access_token)})}function files_list(e){var o=$.query.get("code");""!=o&&null!=o&&null!=o&&($(".loading").removeClass("d-none"),get_doc(o=decode(o),e))}function get_doc(e,o){var t="https://www.googleapis.com/drive/v3/files/"+e+"?alt=media";self.fetch&&((e=new Headers).append("Authorization","Bearer "+o),e.append("Content-Type","text/html"),fetch(t,{method:"GET",headers:e}).then(e=>{var o,a,n;e.ok?(o=e.body.getReader(),a=new TextDecoder,n="",function t(){o.read().then(function(e){var o={};0==(o=a.decode(e.value,{stream:!e.done})).length&&e.done?(editor.setValue(n),$(".loading").addClass("d-none"),submitTryit(1),refreshadSlot1()):(n+=o,t())})}()):($(".loading").addClass("d-none"),alert("حدث خطأ في جلب الرمز الخاص بك. يرجى إعادة المحاولة"))}).catch(e=>{$(".loading").addClass("d-none"),alert("حدث خطأ في جلب الرمز الخاص بك")}))}function CreateFile(){$("#sentCreateFile").attr("disabled","disabled"),$("#spinnerbtnsave").removeClass("d-none"),$("#chooseFileName").val().length<=0?($("#chooseFileNameinvalid").removeClass("d-none"),$("#sentCreateFile").removeAttr("disabled"),$("#spinnerbtnsave").addClass("d-none")):GetUser()}function GetUser(){var e=Cookies.get("UserAccountId");null==e||null==e||""==e?($("#savedcodes").modal("hide"),$("#LoginModalLabel").modal("show")):$.getJSON("https://sheets.googleapis.com/v4/spreadsheets/13ZNpkUYV2X3OSfzjmVUG4I7SjwYWLw9moRK0W7biwAQ/values/responses?",{key:"AIzaSyDpCuvAcL0ESYhI5X9amoy12NGpswwXdlQ",range:"H3:H",majorDimension:"ROWS"}).done(function(e){for(var o=e.values,t=!1,a=Cookies.get("UserAccountId"),n=0,n=parseInt(n),s=0;s<o.length;s++)o[s]==a&&(t=!0,n=s+3);1==t?SaveFile(n):SaveFile1()})}function SaveFile(e){e="A"+e+":Z"+e;$.getJSON("https://sheets.googleapis.com/v4/spreadsheets/13ZNpkUYV2X3OSfzjmVUG4I7SjwYWLw9moRK0W7biwAQ/values/responses?",{key:"AIzaSyDpCuvAcL0ESYhI5X9amoy12NGpswwXdlQ",range:e,majorDimension:"COLUMNS"}).done(function(e){var o=e.values,t=(o[0].toString(),o[1].toString(),o[2].toString()),a=o[3].toString(),n=o[4].toString(),s=o[5].toString(),l=o[6].toString(),e=o[7].toString(),o=o[8].toString();$("#AccountStatus").val(t),$("#UserName").val(a),$("#LastName").val(n),$("#UserEmail").val(s),$("#UserUserID").val(l),$("#UserAccountId").val(e),$("#UserFolder").val(o),UploadfileHtml(o)})}function SaveFile1(){$.getJSON("https://sheets.googleapis.com/v4/spreadsheets/1MSVD6mO_FyPZS5KM2n7sx3fld45BfjtvrFQw-Ldkm5Q/values/responses?",{key:"AIzaSyDpCuvAcL0ESYhI5X9amoy12NGpswwXdlQ",range:"N3:N",majorDimension:"ROWS"}).done(function(e){for(var o=e.values,t=!1,a=Cookies.get("UserAccountId"),n=0,n=parseInt(n),s=0;s<o.length;s++)o[s]==a&&(t=!0,n=s+3);1==t?setUserProfile(n):alert("يرجى تسجيل الدخول")})}function setUserProfile(e){e="A"+e+":Z"+e;$.getJSON("https://sheets.googleapis.com/v4/spreadsheets/1MSVD6mO_FyPZS5KM2n7sx3fld45BfjtvrFQw-Ldkm5Q/values/responses?",{key:"AIzaSyDpCuvAcL0ESYhI5X9amoy12NGpswwXdlQ",range:e,majorDimension:"COLUMNS"}).done(function(e){var o=e.values,t=(o[0].toString(),o[1].toString(),o[2].toString()),a=o[3].toString(),n=o[4].toString(),s=o[5].toString(),l=o[6].toString(),e=(o[7].toString(),o[8].toString(),o[9].toString(),o[10].toString(),o[11].toString(),o[12].toString(),o[13].toString());o[24].toString();$("#AccountStatus").val(t),$("#UserName").val(a),$("#LastName").val(n),$("#UserEmail").val(s),$("#UserUserID").val(l),$("#UserAccountId").val(e),CreateAfolder(decode(a)+"_"+decode(n))})}function UploadfileHtml(l){var r=editor.getValue(),e={body:"grant_type=refresh_token&client_id=174081960663-doarvfi676utb4auvuvhlg54oipc80b5.apps.googleusercontent.com&client_secret=woTFFJ4OpvEuSudjBgtlhzel&refresh_token=1//04JAqwtLVq_HdCgYIARAAGAQSNwF-L9Irftzg9ZHu_o6tB6QGo1-fQVYlcwZaLWblX830BHA1G3QLxRyO8FVGwzVyn_r8-Ykrt0A",method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"})};fetch("https://www.googleapis.com/oauth2/v4/token",e).then(e=>e.json()).then(e=>{!function(e){new Headers({Authorization:"Bearer "+e});var o=l,t=$("#chooseFileName").val(),a=t.replace(/ /gi,"_");$("#NumLetters").val(r.length);var n=new Blob([r],{type:"text/html"}),a={name:a+".html",mimeType:"text/html",parents:[o]};(o=new FormData).append("metadata",new Blob([JSON.stringify(a)],{type:"application/json"})),o.append("file",n);var s=new XMLHttpRequest;s.open("post","https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id"),s.setRequestHeader("Authorization","Bearer "+e),s.responseType="json",s.onload=()=>{var e=s.response.id;$("#FileCodeId").val(e),$("#FileName").val(t),$("#sendToSheetHide").click()},s.send(o)}(e.access_token)})}function showsaveModalLabel(){var o="1";try{o=Cookies.get("UserAccountId")}catch(e){o="1"}(null!=o&&null!=o?$("#savedcodes"):$("#LoginModalLabel")).modal("show")}function openURL(e){window.open(e,"_blank")}function openModal(e,o){"login"==o?$("#loginsign").html("تسجيل الدخول"):$("#loginsign").html("إنشاء حساب جديد"),$("#LoginModalLabel").modal("hide"),$("#iframeModalLabel").modal("show"),$("#iframeModal").attr("src",e)}function donesend(){$("#chooseFileName").val(""),$("#alertmodal").removeClass("d-none"),$("#alertmodalerror").addClass("d-none"),$("#formmodal").addClass("d-none"),$("#sentCreateFile").attr("disabled","disabled"),$("#spinnerbtnsave").addClass("d-none")}function errorsend(){$("#chooseFileName").val(""),$("#alertmodal").addClass("d-none"),$("#alertmodalerror").removeClass("d-none"),$("#formmodal").addClass("d-none")}function CreateAfolder(o){var e={body:"grant_type=refresh_token&client_id=174081960663-doarvfi676utb4auvuvhlg54oipc80b5.apps.googleusercontent.com&client_secret=woTFFJ4OpvEuSudjBgtlhzel&refresh_token=1//04JAqwtLVq_HdCgYIARAAGAQSNwF-L9Irftzg9ZHu_o6tB6QGo1-fQVYlcwZaLWblX830BHA1G3QLxRyO8FVGwzVyn_r8-Ykrt0A",method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"})};fetch("https://www.googleapis.com/oauth2/v4/token",e).then(e=>e.json()).then(e=>{Createfolder(e.access_token,o)})}function Createfolder(e,o){var t=o,o=Cookies.get("UserAccountId");""!=t||(t=""!=o?o:"file");o={name:t=t.replace(/ /gi,"_"),mimeType:"application/vnd.google-apps.folder",parents:["1kNkjAwyeTd-QdddSk2_7NuDljeoqnUcC"]},t=new FormData;t.append("metadata",new Blob([JSON.stringify(o)],{type:"application/json"}));var a=new XMLHttpRequest;a.open("post","https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,kind"),a.setRequestHeader("Authorization","Bearer "+e),a.responseType="json",a.onload=()=>{var e=a.response.id;a.response.name;$("#UserFolder").val(e),UploadfileHtml(e)},a.send(t)}$(document).ready(function(){getFile()}),$("#savedcodes").on("show.bs.modal",function(){$("#alertmodal").addClass("d-none"),$("#alertmodalerror").addClass("d-none"),$("#formmodal").removeClass("d-none"),$("#sentCreateFile").removeAttr("disabled"),$("#spinnerbtnsave").addClass("d-none"),$("#chooseFileName").val("")});